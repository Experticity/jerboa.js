!function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t){"use strict";!function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}var r=n(1),i=a(r);window.jerboa=i["default"]},function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=(0,o.resolveContainer)(e.target,u["default"].currentStrategy);if(t){var n=(0,o.getSelector)(e.target),a=(0,o.getSelector)(t),r=(0,o.getRelativeOffset)(e.target,t);r[0]+=e.offsetX,r[1]+=e.offsetY;var i=t.getBoundingClientRect(),d={positioning:u["default"].currentPositioning,target:n,container:a,containerSize:{width:i.width,height:i.height},windowSize:{width:window.innerWidth,height:window.innerHeight},offset:r};return{datetime:(new Date).toISOString(),position:d,url:window.location.href,data:u["default"].additionalData,user:u["default"].currentUser}}}function i(e){if((0,c.closeInfoBox)(),!u["default"].feedbackBoxOpen){var t=r(e);if(t){(0,d.emit)("preAnnotate",t),u["default"].feedbackBoxOpen=!0;var n=(0,c.createMarker)(t),a=(0,c.addBox)(n,!1),i=(0,c.addTextField)(a.container,"Enter comment:");i.cancel.addEventListener("click",function(){(0,d.emit)("cancel",t),u["default"].feedbackBoxOpen=!1,document.body.removeChild(n)}),i.save.addEventListener("click",function(){t.comments=[{text:i.textarea.value,user:u["default"].currentUser,datetime:(new Date).toISOString(),replies:[]}],(0,d.emit)("save",t),u["default"].feedbackBoxOpen=!1,n.removeChild(a.box),(0,c.createInfoBox)(n,t)})}}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),d=n(3),c=n(4),l=n(5),u=a(l),s={global:function(e){return"BODY"===e.tagName},byClass:function(e){return function(t){return t.classList.contains(e)}}};t["default"]={init:function(e){e=e||{},e.data&&(u["default"].additionalData=e.data),e.points&&e.points.forEach(function(e){var t=(0,c.createMarker)(e);(0,c.createInfoBox)(t,e)}),u["default"].currentStrategy=e.strategy||s.global,u["default"].currentPositioning=e.positioning||"percent",u["default"].currentUser=e.user,document.addEventListener("click",i)},close:function(){document.removeEventListener("click",i)},addEventListener:d.addEventListener,strategies:s}},function(e,t){function n(e,t){if("BODY"===e.tagName)return"body"+(t?" > "+t:"");if(e.id)return"#"+e.id+(t?" > "+t:"");var a=Array.prototype.slice.call(e.parentElement.children).indexOf(e),r=e.tagName.toLowerCase()+":nth-child("+(a+1)+")"+(t?" > "+t:"");return n(e.parentElement,r)}function a(e,t){var n=r(e),a=r(t);return[n[0]-a[0],n[1]-a[1]]}function r(e){return[e.offsetLeft,e.offsetTop]}function i(e,t){return t(e)?e:"HTML"===e.tagName?null:i(e.parentElement,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.getSelector=n,t.getRelativeOffset=a,t.getGlobalOffset=r,t.resolveContainer=i},function(e,t){function n(e,t){r[e]&&r[e].forEach(function(e){return e(t)})}function a(e,t){r[e]||(r[e]=[]),r[e].push(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.emit=n,t.addEventListener=a;var r={};t.__listeners=r},function(e,t,n){function a(e){return e&&e.__esModule?e:{"default":e}}function r(){return x}function i(e){x=e}function o(e){var t=e.position,n=document.querySelector(t.container),a=(0,v.getGlobalOffset)(n),r=document.createElement("div"),i=void 0,o=void 0;if(r.classList.add("feedback-spot"),"pixel"===t.positioning)i=a[0]+t.offset[0],o=a[1]+t.offset[1];else if("percent"===t.positioning){var d=t.offset[0]/t.containerSize.width,c=t.offset[1]/t.containerSize.height,l=n.getBoundingClientRect();i=a[0]+l.width*d,o=a[1]+l.height*c}return r.style.top=o+"px",r.style.left=i+"px",document.body.appendChild(r),r}function d(e,t){e.addEventListener("click",function(n){n.stopPropagation(),t&&(e.classList.toggle("active"),x!==e?(c(),x=e):x=null)});var n=document.createElement("div");n.classList.add("feedback-box"),t&&n.classList.add("toggled"),n.addEventListener("click",function(e){e.stopPropagation()}),e.appendChild(n);var a=document.createElement("div");return a.classList.add("feedback-container"),n.appendChild(a),{box:n,container:a}}function c(){x&&(x.classList.remove("active"),x=null)}function l(e,t){var n=document.createElement("div");n.classList.add("feedback-text"),n.textContent=t.text,e.appendChild(n);var a=document.createElement("div");a.classList.add("feedback-info");var r=new Date(t.datetime);if(a.textContent="By "+(t.user||"unknown user")+" at "+r.toLocaleString(),n.appendChild(a),t.user===h["default"].currentUser){var i=document.createElement("a");i.classList.add("delete-button"),i.innerText="X",i.setAttribute("role","button"),i.setAttribute("href","#"),a.appendChild(i);var o=document.createElement("a");o.classList.add("edit-button"),o.innerText="Edit",o.setAttribute("role","button"),o.setAttribute("href","#"),a.appendChild(o),i.addEventListener("click",function(t){t.preventDefault(),e.removeChild(n),(0,p.emit)("deleteComment")}),o.addEventListener("click",function(e){e.preventDefault(),(0,p.emit)("editComment")})}var d=document.createElement("a");d.classList.add("reply-button"),d.innerText="Reply",d.setAttribute("role","button"),d.setAttribute("href","#"),n.appendChild(d);var l=document.createElement("div");return l.classList.add("replies-container"),n.appendChild(l),t.replies&&t.replies.forEach(function(e){u(l,e)}),d.addEventListener("click",function(e){e.preventDefault();var n=void 0;!l||l.lastElementChild&&l.lastElementChild.classList.contains("reply-textfield")||(n=s(l,"Reply:","reply-textfield"),n.cancel.addEventListener("click",function(){var e=g(n.textarea.value);n.textarea.value="",(0,p.emit)("cancelReply",e),c()}),n.save.addEventListener("click",function(){var e=g(n.textarea.value);n.textarea.value="",t.replies.push(e),(0,p.emit)("saveReply",t),l.removeChild(n.container),u(l,e)}))}),n}function u(e,t){var n=document.createElement("div");n.classList.add("reply-container"),e.appendChild(n);var a=document.createElement("div");a.classList.add("feedback-reply"),a.textContent=t.text,n.appendChild(a);var r=document.createElement("div");r.classList.add("feedback-info");var i=new Date(t.datetime);if(r.textContent="By "+(t.user||"unknown user")+" at "+i.toLocaleString(),t.user===h["default"].currentUser){var o=document.createElement("a");o.classList.add("delete-button"),o.innerText="X",o.setAttribute("role","button"),o.setAttribute("href","#"),r.appendChild(o);var d=document.createElement("a");d.classList.add("edit-button"),d.innerText="Edit",d.setAttribute("role","button"),d.setAttribute("href","#"),r.appendChild(d),o.addEventListener("click",function(t){t.preventDefault(),e.removeChild(n),(0,p.emit)("deleteReply")}),d.addEventListener("click",function(e){e.preventDefault(),(0,p.emit)("editReply")})}return n.appendChild(r),n}function s(e,t,n){var a=document.createElement("div");n&&a.classList.add(n),e.appendChild(a);var r=document.createElement("label");r.textContent=t,a.appendChild(r);var i=document.createElement("textarea");a.appendChild(i);var o=document.createElement("div");o.classList.add("button-holder"),a.appendChild(o);var d=document.createElement("button");d.classList.add("cancel-button"),d.innerText="Cancel",o.appendChild(d);var c=document.createElement("button");return c.classList.add("save-button"),c.innerText="Save",o.appendChild(c),{cancel:d,save:c,textarea:i,container:a}}function f(e,t){function n(e,t){e.forEach(function(t,n){t.includes("owner-")&&e.remove(t)}),e.add(t)}function a(e,t){e.forEach(function(t,n){t.includes("status-")&&e.remove(t)}),e.add(t)}var r=d(e,!0),i={PM:"pm",Client:"client",ID:"id",IxD:"ixd",Video:"video"},o={Open:"open",Closed:"closed","No Action":"no-action"},u=document.createElement("select");r.container.appendChild(u);for(var f=Object.keys(i),v=0;v<f.length;v++){var m=document.createElement("option");m.value=f[v],m.text=f[v],u.appendChild(m)}u.addEventListener("change",function(t){var a=t.target.value;n(e.classList,"owner-"+i[a])});var h=document.createElement("select");r.container.appendChild(h);for(var x=Object.keys(o),g=0;g<x.length;g++){var E=document.createElement("option");E.value=x[g],E.text=x[g],h.appendChild(E)}h.addEventListener("change",function(t){var n=t.target.value;a(e.classList,"status-"+o[n])}),t.comments.forEach(function(e){l(r.container,e)});var C=s(r.container,"Comment:");return C.cancel.addEventListener("click",function(){var e=b(C.textarea.value);C.textarea.value="",(0,p.emit)("cancelComment",e),c()}),C.save.addEventListener("click",function(){var e=b(C.textarea.value);C.textarea.value="",t.comments.push(e),(0,p.emit)("saveComment",t),r.container.removeChild(C.container),l(r.container,e),r.container.appendChild(C.container)}),Object.assign({},C,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.__getOpenSpot=r,t.__setOpenSpot=i,t.createMarker=o,t.addBox=d,t.closeInfoBox=c,t.addText=l,t.addReply=u,t.addTextField=s,t.createInfoBox=f;var v=n(2),p=n(3),m=n(5),h=a(m),x=void 0,g=function(e){return{datetime:(new Date).toISOString(),user:h["default"].currentUser,text:e}},b=function(e){return{datetime:(new Date).toISOString(),user:h["default"].currentUser,text:e,replies:[]}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={currentStrategy:void 0,currentUser:void 0,currentPositioning:void 0,additionalData:void 0,feedbackBoxOpen:!1}}])}]);