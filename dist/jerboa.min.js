!function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t){!function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}var r=n(1),i=a(r);window.jerboa=i["default"]},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=(0,o.resolveContainer)(e.target,u["default"].currentStrategy);if(t){var n=(0,o.getSelector)(e.target),a=(0,o.getSelector)(t),r=(0,o.getRelativeOffset)(e.target,t);r[0]+=e.offsetX,r[1]+=e.offsetY;var i=t.getBoundingClientRect(),d={positioning:u["default"].currentPositioning,target:n,container:a,containerSize:{width:i.width,height:i.height},windowSize:{width:window.innerWidth,height:window.innerHeight},offset:r};return{datetime:(new Date).toISOString(),position:d,url:window.location.href,data:u["default"].additionalData,user:u["default"].currentUser,replies:[]}}}function i(e){if((0,c.closeInfoBox)(),!u["default"].feedbackBoxOpen){var t=r(e);if(t){(0,d.emit)("preAnnotate",t),u["default"].feedbackBoxOpen=!0;var n=(0,c.createMarker)(t),a=(0,c.addBox)(n,!1),i=(0,c.addTextField)(a.container,"Enter message:");i.cancel.addEventListener("click",function(){(0,d.emit)("cancel",t),u["default"].feedbackBoxOpen=!1,document.body.removeChild(n)}),i.save.addEventListener("click",function(){t.text=i.textarea.value,(0,d.emit)("save",t),u["default"].feedbackBoxOpen=!1,n.removeChild(a.box),(0,c.createInfoBox)(n,t)})}}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),d=n(3),c=n(4),l=n(5),u=a(l),s={global:function(e){return"BODY"===e.tagName},byClass:function(e){return function(t){return t.classList.contains(e)}}};t["default"]={init:function(e){e=e||{},e.data&&(u["default"].additionalData=e.data),e.points&&e.points.forEach(function(e){var t=(0,c.createMarker)(e);(0,c.createInfoBox)(t,e)}),u["default"].currentStrategy=e.strategy||s.global,u["default"].currentPositioning=e.positioning||"percent",u["default"].currentUser=e.user,document.addEventListener("click",i)},close:function(){document.removeEventListener("click",i)},addEventListener:d.addEventListener,strategies:s}},function(e,t){"use strict";function n(e,t){if("BODY"===e.tagName)return"body"+(t?" > "+t:"");if(e.id)return"#"+e.id+(t?" > "+t:"");var a=Array.prototype.slice.call(e.parentElement.children).indexOf(e),r=e.tagName.toLowerCase()+":nth-child("+(a+1)+")"+(t?" > "+t:"");return n(e.parentElement,r)}function a(e,t){var n=r(e),a=r(t);return[n[0]-a[0],n[1]-a[1]]}function r(e){return[e.offsetLeft,e.offsetTop]}function i(e,t){return t(e)?e:"HTML"===e.tagName?null:i(e.parentElement,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.getSelector=n,t.getRelativeOffset=a,t.getGlobalOffset=r,t.resolveContainer=i},function(e,t){"use strict";function n(e,t){r[e]&&r[e].forEach(function(e){return e(t)})}function a(e,t){r[e]||(r[e]=[]),r[e].push(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.emit=n,t.addEventListener=a;var r={}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=e.position,n=document.querySelector(t.container),a=(0,u.getGlobalOffset)(n),r=document.createElement("div"),i=void 0,o=void 0;if(r.classList.add("feedback-spot"),"pixel"===t.positioning)i=a[0]+t.offset[0],o=a[1]+t.offset[1];else if("percent"===t.positioning){var d=t.offset[0]/t.containerSize.width,c=t.offset[1]/t.containerSize.height,l=n.getBoundingClientRect();i=a[0]+l.width*d,o=a[1]+l.height*c}return r.style.top=o+"px",r.style.left=i+"px",document.body.appendChild(r),r}function i(e,t){e.addEventListener("click",function(n){n.stopPropagation(),t&&(e.classList.toggle("active"),p!==e?(o(),p=e):p=null)});var n=document.createElement("div");n.classList.add("feedback-box"),t&&n.classList.add("toggled"),n.addEventListener("click",function(e){e.stopPropagation()}),e.appendChild(n);var a=document.createElement("div");return a.classList.add("feedback-container"),n.appendChild(a),{box:n,container:a}}function o(){p&&(p.classList.remove("active"),p=null)}function d(e,t){var n=document.createElement("div");n.classList.add("feedback-text"),n.textContent=t.text,e.appendChild(n);var a=document.createElement("div");a.classList.add("feedback-info");var r=new Date(t.datetime);a.textContent="By "+(t.user||"unknown user")+" at "+r.toLocaleString(),n.appendChild(a)}function c(e,t){var n=document.createElement("div");e.appendChild(n);var a=document.createElement("label");a.textContent=t,n.appendChild(a);var r=document.createElement("textarea");n.appendChild(r);var i=document.createElement("div");i.classList.add("button-holder"),n.appendChild(i);var o=document.createElement("button");o.classList.add("cancel-button"),o.innerText="Cancel",i.appendChild(o);var d=document.createElement("button");return d.classList.add("save-button"),d.innerText="Save",i.appendChild(d),{cancel:o,save:d,textarea:r,container:n}}function l(e,t){var n=i(e,!0);d(n.container,t),t.replies.forEach(function(e){d(n.container,e)});var a=c(n.container,"Reply:");a.cancel.addEventListener("click",function(){var e={datetime:(new Date).toISOString(),user:v["default"].currentUser,text:a.textarea.value};a.textarea.value="",(0,s.emit)("cancelReply",e),o()}),a.save.addEventListener("click",function(){var e={datetime:(new Date).toISOString(),user:v["default"].currentUser,text:a.textarea.value};a.textarea.value="",t.replies.push(e),(0,s.emit)("saveReply",t),n.container.removeChild(a.container),d(n.container,e),n.container.appendChild(a.container)})}Object.defineProperty(t,"__esModule",{value:!0}),t.createMarker=r,t.addBox=i,t.closeInfoBox=o,t.addText=d,t.addTextField=c,t.createInfoBox=l;var u=n(2),s=n(3),f=n(5),v=a(f),p=void 0},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={currentStrategy:void 0,currentUser:void 0,currentPositioning:void 0,additionalData:void 0,feedbackBoxOpen:!1}}])}]);
//# sourceMappingURL=jerboa.min.js.map