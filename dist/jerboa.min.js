!function(e){function t(a){if(n[a])return n[a].exports;var o=n[a]={exports:{},id:a,loaded:!1};return e[a].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t){"use strict";!function(e){function t(a){if(n[a])return n[a].exports;var o=n[a]={exports:{},id:a,loaded:!1};return e[a].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function a(e){return e&&e.__esModule?e:{default:e}}var o=n(1),i=a(o);window.jerboa=i.default},function(e,t,n){function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(0,c.resolveContainer)(e.target,u.default.currentStrategy);if(t){var n=(0,c.getSelector)(e.target),a=(0,c.getSelector)(t),o=(0,c.getRelativeOffset)(e.target,t);o.x+=e.offsetX,o.y+=e.offsetY;var i=t.getBoundingClientRect(),r={positioning:u.default.currentPositioning,target:n,container:a,containerSize:{width:i.width,height:i.height},windowSize:{width:window.innerWidth,height:window.innerHeight},offset:o};return{time:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString(),position:r,url:u.default.url,data:u.default.additionalData,user:u.default.currentUser,userId:u.default.currentUserId,comments:[]}}}function i(e){if(u.default.active&&((0,l.closeInfoBox)(),!u.default.feedbackBoxOpen)){var t=o(e);if(t){(0,d.emit)("preAnnotate",t),u.default.feedbackBoxOpen=!0;var n=(0,l.createMarker)(t),a=(0,l.addBox)(n,!1),i=(0,l.addTextField)(a.container,"Enter comment:");i.cancel.addEventListener("click",function(){(0,d.emit)("cancel",t),u.default.feedbackBoxOpen=!1,document.body.removeChild(n)}),i.save.addEventListener("click",function(){i.textarea.value?(t.text=i.textarea.value,(0,d.emit)("save",t),u.default.feedbackBoxOpen=!1,n.removeChild(a.box),(0,l.createInfoBox)(n,t)):((0,d.emit)("cancel",t),u.default.feedbackBoxOpen=!1,document.body.removeChild(n))})}}}function r(){var e="25px",t="25px",n=document.createElement("div");n.classList.add("toggle-button-container");var a=document.createElement("div");a.classList.add("toggle-button-text"),a.textContent="Feedback Off",n.appendChild(a);var o=document.createElement("div");o.classList.add("toggle-button"),n.appendChild(o);var i=document.createElement("button");o.appendChild(i),n.style.bottom=e,n.style.left=t,n.style.position="fixed";var r=function(){var e=document.getElementsByClassName("feedback-spot");u.default.active?(o.classList.add("toggle-button-selected"),a.textContent="Feedback On",Array.prototype.forEach.call(e,function(e){e.classList.remove("off")})):(o.classList.remove("toggle-button-selected"),a.textContent="Feedback Off",Array.prototype.forEach.call(e,function(e){e.classList.add("off")}))};o.addEventListener("click",function(e){e.preventDefault(),u.default.active=!u.default.active,r(),(0,d.emit)("active",u.default.active)}),r(),document.body.appendChild(n)}Object.defineProperty(t,"__esModule",{value:!0});var c=n(2),d=n(3),l=n(4),s=n(5),u=a(s),f={global:function(e){return"BODY"===e.tagName},byClass:function(e){return function(t){return t.classList.contains(e)}}};!function(){var e=function(e,t,n){n=n||window;var a=!1,o=function(){a||(a=!0,requestAnimationFrame(function(){n.dispatchEvent(new CustomEvent(t)),a=!1}))};n.addEventListener(e,o)};e("resize","optimizedResize")}(),t.default={init:function(e){console.log("options",e),e=e||{},u.default.active=e.active||!1,u.default.currentStrategy=e.strategy||f.global,u.default.currentPositioning=e.positioning||"PERCENT",u.default.currentUser=e.currentUser,u.default.currentUserId=e.currentUserId,u.default.isAdmin=e.isAdmin||!1,u.default.url=window.location.href,console.log("state",u.default),e.data&&(u.default.additionalData=e.data),e.points&&e.points.forEach(function(e){var t=(0,l.createMarker)(e,!0);(0,l.createInfoBox)(t,e)}),document.addEventListener("click",i),window.addEventListener("optimizedResize",function(){console.log("Resource conscious resize callback!"),l.annotationPositions.forEach(function(e){l.resetPositioning.apply(null,e)})}),r()},close:function(){document.removeEventListener("click",i)},addEventListener:d.addEventListener,strategies:f}},function(e,t){function n(e,t){if("BODY"===e.tagName)return"body"+(t?" > "+t:"");if(e.id)return"#"+e.id+(t?" > "+t:"");var a=Array.prototype.slice.call(e.parentElement.children).indexOf(e),o=e.tagName.toLowerCase()+":nth-child("+(a+1)+")"+(t?" > "+t:"");return n(e.parentElement,o)}function a(e,t){var n=o(e),a=o(t);return console.log("offset: ",n,"cOffset: ",a),{x:n[0]-a[0],y:n[1]-a[1]}}function o(e){var t=e.getBoundingClientRect(),n=t.left+document.body.scrollLeft,a=t.top+document.body.scrollTop;return console.log(1,n,2,a,3,e.offsetLeft,4,e.offsetTop),[n,a]}function i(e,t){return console.log("elem",e),console.log("strategy",t),console.log("strategy(elem)",t(e)),t(e)?e:"HTML"===e.tagName?null:i(e.parentElement,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.getSelector=n,t.getRelativeOffset=a,t.getGlobalOffset=o,t.resolveContainer=i},function(e,t){function n(e,t){o[e]&&o[e].forEach(function(e){return e(t)})}function a(e,t){o[e]||(o[e]=[]),o[e].push(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.emit=n,t.addEventListener=a;var o={};t.__listeners=o},function(e,t,n){function a(e){return e&&e.__esModule?e:{default:e}}function o(){return b}function i(e){b=e}function r(e,t){var n=e.position,a=document.querySelector(n.container),o=document.createElement("div");o.classList.add("feedback-spot"),t&&o.classList.add("off"),C.push([o,n,a]);var i=c(n,a);return o.style.top=i.top+"px",o.style.left=i.left+"px",document.body.appendChild(o),o}function c(e,t){var n=(0,m.getGlobalOffset)(t),a=void 0,o=void 0;if("PIXEL"===e.positioning)o=n[0]+e.offset.x,a=n[1]+e.offset.y;else if("PERCENT"===e.positioning){var i=e.offset.x/e.containerSize.width,r=e.offset.y/e.containerSize.height,c=t.getBoundingClientRect();o=n[0]+c.width*i,a=n[1]+c.height*r}return{top:a,left:o}}function d(e,t,n){var a=c(t,n);e.style.top=a.top+"px",e.style.left=a.left+"px"}function l(e,t){e.addEventListener("click",function(n){x.default.active&&(n.stopPropagation(),t&&(e.classList.toggle("active"),b!==e?(s(),b=e):b=null))});var n=document.createElement("div");n.classList.add("feedback-box"),t&&n.classList.add("toggled"),n.addEventListener("click",function(e){e.stopPropagation()}),e.appendChild(n);var a=document.createElement("div");return a.classList.add("feedback-container"),n.appendChild(a),{box:n,container:a}}function s(){b&&(b.classList.remove("active"),b=null)}function u(e,t,n){var a=document.createElement("div");a.classList.add("feedback-text"),n&&a.classList.add(n),e.appendChild(a);var o=document.createElement("div");o.classList.add("feedback-comment"),o.textContent=t.text,a.appendChild(o);var i=document.createElement("div");i.classList.add("feedback-info");var r=t.time.match(/.*[Z]$/)?t.time:t.time+"Z",c=(0,h.isSafari)()?Date.parse(r)+6e4*(new Date).getTimezoneOffset():Date.parse(r),d=new Date(c);if(i.textContent="By "+(t.user||x.default.currentUser||"unknown user")+" at "+d.toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric",timeZone:"UTC",hour12:!0,hour:"numeric",minute:"numeric"}),a.appendChild(i),parseInt(t.userId)===parseInt(x.default.currentUserId)){var l=document.createElement("a");l.classList.add("delete-button"),l.innerText="X",l.setAttribute("role","button"),l.setAttribute("href","#"),t.hasOwnProperty("comments")||i.appendChild(l);var s=document.createElement("a");s.classList.add("edit-button"),s.innerText="Edit",s.setAttribute("role","button"),s.setAttribute("href","#"),i.appendChild(s),l.addEventListener("click",function(n){n.preventDefault(),e.removeChild(a),(0,p.emit)("deleteComment",t)}),s.addEventListener("click",function(n){n.preventDefault();var o=f(null,null,"comment-textfield");o.textarea.value=t.text,o.cancel.addEventListener("click",function(){e.replaceChild(a,o.container)}),o.save.addEventListener("click",function(){t.text===o.textarea.value?e.replaceChild(a,o.container):(t.text=o.textarea.value,a.children[0].textContent=t.text,e.replaceChild(a,o.container),(0,p.emit)("saveEdittedComment",t))}),e.replaceChild(o.container,a),(0,p.emit)("editComment")})}return a}function f(e,t,n){var a=document.createElement("div");if(n&&a.classList.add(n),e&&e.appendChild(a),t){var o=document.createElement("label");o.textContent=t,a.appendChild(o)}var i=document.createElement("textarea");a.appendChild(i);var r=document.createElement("div");r.classList.add("button-holder"),a.appendChild(r);var c=document.createElement("button");c.classList.add("cancel-button"),c.innerText="Cancel",r.appendChild(c);var d=document.createElement("button");return d.classList.add("save-button"),d.innerText="Save",r.appendChild(d),{cancel:c,save:d,textarea:i,container:a}}function v(e,t){function n(e,t,n){e.contains(t)&&e.remove(t),e.contains(n)||e.add(n)}var a=l(e,!0),o={PM:"pm",Client:"client",ID:"id",IxD:"ixd",Video:"video"},i={Open:"open",Closed:"closed","No Action":"no-action"},r="pm",c=document.createElement("select");x.default.isAdmin||(c.disabled=!0),a.container.appendChild(c);for(var d=Object.keys(o),v=0;v<d.length;v++){var m=document.createElement("option");m.value=o[d[v]],m.text=d[v],c.appendChild(m)}var g=t.assigneeRole;t.assigneeRole&&t.assigneeRole!==r?(c.value=t.assigneeRole,n(e.classList,null,"owner-"+t.assigneeRole)):c.value=r,c.addEventListener("change",function(a){t.assigneeRole=a.target.value,n(e.classList,"owner-"+g,"owner-"+t.assigneeRole),g=t.assigneeRole,(0,p.emit)("changeOwner",t)});var h="open",b=document.createElement("select");x.default.isAdmin||(b.disabled=!0),a.container.appendChild(b);for(var C=Object.keys(i),L=0;L<C.length;L++){var y=document.createElement("option");y.value=i[C[L]],y.text=C[L],b.appendChild(y)}var O=t.status;t.status&&t.status!==h?(b.value=t.status,n(e.classList,null,"status-"+t.status)):b.value=h,b.addEventListener("change",function(a){t.status=a.target.value,n(e.classList,"status-"+O,"status-"+t.status),O=t.status,(0,p.emit)("changeStatus",t)}),u(a.container,t),t.comments.forEach(function(e){u(a.container,e,"comment-reply")});var k=f(a.container,"Comment:","comment-textfield");return k.cancel.addEventListener("click",function(){var e=E(k.textarea.value);k.textarea.value="",(0,p.emit)("cancelComment",e),s()}),k.save.addEventListener("click",function(){if(k.textarea.value){var e=E(k.textarea.value);k.textarea.value="",t.comments.push(e),(0,p.emit)("saveComment",t),a.container.removeChild(k.container),u(a.container,e,"comment-reply"),a.container.appendChild(k.container)}else{var n=E(k.textarea.value);k.textarea.value="",(0,p.emit)("cancelComment",n),s()}}),Object.assign({},k,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.annotationPositions=void 0,t.__getOpenSpot=o,t.__setOpenSpot=i,t.createMarker=r,t.resetPositioning=d,t.addBox=l,t.closeInfoBox=s,t.addText=u,t.addTextField=f,t.createInfoBox=v;var m=n(2),p=n(3),g=n(5),x=a(g),h=n(6),b=void 0,C=t.annotationPositions=[],E=function(e){return{time:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString(),user:x.default.currentUser,userId:x.default.currentUserId,text:e}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={active:!1,currentStrategy:void 0,currentUser:void 0,currentUserId:void 0,currentPositioning:void 0,additionalData:void 0,feedbackBoxOpen:!1,url:void 0,isAdmin:!1}},function(e,t){function n(){var e=navigator.userAgent.toLowerCase();return e.indexOf("safari")!==-1&&e.indexOf("chrome")===-1}Object.defineProperty(t,"__esModule",{value:!0}),t.isSafari=n}])}]);